{"version":3,"sources":["webpack:///D:/JK-WorkFile/Code/DSJK/DSJK-uni/main.js","webpack:///D:/JK-WorkFile/Code/DSJK/DSJK-uni/pages/login/login.vue?1dd8","webpack:///D:/JK-WorkFile/Code/DSJK/DSJK-uni/pages/login/login.vue?3568","webpack:///D:/JK-WorkFile/Code/DSJK/DSJK-uni/pages/login/login.vue?e11f","webpack:///D:/JK-WorkFile/Code/DSJK/DSJK-uni/pages/login/login.vue?2e07","webpack:///D:/JK-WorkFile/Code/DSJK/DSJK-uni/pages/login/login.vue"],"names":["createPage","Page","data","onLoginBTN","onShow","uni","login","success","loginRes","code","console","log","store_UserInfo","nickName","getSetting","store_UserData","openid","methods","res","authSetting","getUserInfo","userInfo","avatarUrl","gender","province","city","country","bindGetUserInfo","e","target","setUserInfo","http_getUserInfo","rawData","signature","setToken","computed"],"mappings":"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","file":"pages/login/login.js","sourcesContent":["import 'uni-pages';import '@dcloudio/uni-stat';\n\nimport Vue from 'vue'            \nimport Page from './pages/login/login.vue'\ncreatePage(Page)","import { render, staticRenderFns } from \"./login.vue?vue&type=template&id=1d6f2eca&\"\nimport script from \"./login.vue?vue&type=script&lang=js&\"\nexport * from \"./login.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!F:\\\\JK-apps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"F:\\\\JK-apps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-hot-reload-api\\\\dist\\\\index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!module.hot.data) {\n      api.createRecord('1d6f2eca', component.options)\n    } else {\n      api.reload('1d6f2eca', component.options)\n    }\n    module.hot.accept(\"./login.vue?vue&type=template&id=1d6f2eca&\", function () {\n      api.rerender('1d6f2eca', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"D:/JK-WorkFile/Code/DSJK/DSJK-uni/pages/login/login.vue\"\nexport default component.exports","export * from \"-!F:\\\\JK-apps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!F:\\\\JK-apps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!F:\\\\JK-apps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!F:\\\\JK-apps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\JK-apps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-custom-block-loader\\\\index.js??ref--0-1!F:\\\\JK-apps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./login.vue?vue&type=template&id=1d6f2eca&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import mod from \"-!F:\\\\JK-apps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!F:\\\\JK-apps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!F:\\\\JK-apps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!F:\\\\JK-apps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\JK-apps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-custom-block-loader\\\\index.js??ref--0-1!F:\\\\JK-apps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./login.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!F:\\\\JK-apps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!F:\\\\JK-apps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!F:\\\\JK-apps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!F:\\\\JK-apps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!F:\\\\JK-apps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-custom-block-loader\\\\index.js??ref--0-1!F:\\\\JK-apps\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./login.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n\n\t// 能够进入这个页面，说明当前用户未登录，这里进行登录操作；\n\t// 其他页面在监测用户是否登录，如果未登录，跳转到此页面；\n\t/* 页面逻辑\n\t\t \n\t */\n\t\n\t// 拿到vuex中的函数\n\timport {mapGetters, mapMutations} from 'vuex'\n\t// 引入自己封装的发送http请求的函数\n\timport {http_login_setToken} from '../../utils/http_login_setToken.js'\n\texport default {\n\t\tdata () {\n\t\t\treturn {\n\t\t\t\t// 授权按钮是否显示，当没有获取用户授权时，显示授权按钮\n\t\t\t\tonLoginBTN: false\n\t\t\t}\n\t\t},\n\t\t// 监听页面显示。\n\t\t// 页面每次出现在屏幕上都触发，包括从下级页面点返回露出当前页面\n\t\tasync onShow () {\n\t\t\t\n\t\t\t// 用户登录后，向后台换取token存储到本地\n\t\t\tawait uni.login({\n\t\t\t  success: (loginRes) => {\n\t\t\t\t\t// 拿到用户登录Code，发送给后台，后台返回token值，将token存储到本地中；\n\t\t\t\t\tif (loginRes.code) {\n\t\t\t\t\t\tconsole.log('login-------------')\n\t\t\t\t\t\thttp_login_setToken()\n\t\t\t\t\t}\n\t\t\t  }\n\t\t\t})\n\t\t\t\n\n\t\t\t// 检查本地是否能够拿到用户信息、用户数据\n\t\t\t// 如果本地拿不到用户信息、用户数据，那么就执=> 1、行获取用户设置\n\t\t\t// 这里的storeUserInfo是通过vuex提供的辅助函数mapGetters，取到getters.js中的内容，目的：获取本地存储的用户信息（不包含敏感数据）\n\t\t\tif (!this.store_UserInfo.nickName) { \n\t\t\t\tconsole.log('本地用户信息为空，尝试获取“获取用户信息的授权”')\n\t\t\t\t// 先显示页面时，就检查用户是否授权，如果未授权，提示授权，如果授权则进行登录；\n\t\t\t\t// 这个检测授权只能在小程序端使用,所以使用uniapp的条件渲染，取反，不在APP和H5执行这个函数\n\n\t\t\t\tthis.getSetting()\n\n\t\t\t\t\n\t\t\t} else if (!this.store_UserData.openid) { // 判断是否能够拿到包含敏感信息的用户信息\n\t\t\t\tconsole.log('用户基本信息')\n\t\t\t\tconsole.log(this.store_UserData)\n\t\t\t\t\n\t\t\t} else { // 用户数据和用户信息都可以拿到，允许进入其他页面\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\t\n\n\t\t},\n\t\tmethods: {\n\t\t\t\n\t\t\t// 1、获取用户设置\n\t\t\tgetSetting () {\n\t\t\t\tuni.getSetting({\n\t\t\t\t  success: (res) => {\n\t\t\t\t\t\tif (res.authSetting[\"scope.userInfo\"]) {\n\t\t\t\t\t\t\tconsole.log('已获取用户“用户信息授权，直接获取用户信息（非敏感数据）”')\n\t\t\t\t\t\t\t// 用户已授权：用户信息\n\t\t\t\t\t\t\t// 获取用户信息\n\t\t\t\t\t\t\tthis.getUserInfo()\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// 未授权用户信息,显示授权用户信息按钮，隐藏其他按钮；\n\t\t\t\t\t\t\tthis.onLoginBTN = true\n\t\t\t\t\t\t}\n\t\t\t\t    // res.authSetting = {\n\t\t\t\t    //   \"scope.userInfo\": true,\n\t\t\t\t    //   \"scope.userLocation\": true\n\t\t\t\t    // }\n\t\t\t\t  }\n\t\t\t\t})\n\t\t\t},\n\t\t\t\n\t\t\t\n\t\t\t// 获取用户信息授权\n\t\t\t// 获取用户信息\n\t\t\tgetUserInfo () {\n\t\t\t\tconsole.log('用户已授权，获取用户信息↓↓↓')\n\t\t\t\tuni.getUserInfo({\n\t\t\t\t  success: (res) => {\n\t\t\t\t\t\t// 获取成功，存本地\n\t\t\t\t\t  console.log(res)\n\t\t\t\t    var userInfo = res.userInfo\n\t\t\t\t    var nickName = userInfo.nickName\n\t\t\t\t    var avatarUrl = userInfo.avatarUrl\n\t\t\t\t    var gender = userInfo.gender //性别 0：未知、1：男、2：女\n\t\t\t\t    var province = userInfo.province\n\t\t\t\t    var city = userInfo.city\n\t\t\t\t    var country = userInfo.country\n\t\t\t\t  }\n\t\t\t\t})\n\t\t\t},\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t// 用户点击授权按钮后，弹出弹窗，然后在弹窗点取消或授权，会进入这个函数\n\t\t\t// 这个@getuserinfo是uniapp提供的处理事件，只适用于微信小程序，\n\t\t\t// 在点击这个按钮后，会触发bindGetUserInfo，然后拿到用户点击弹窗授权的回调函数\n\t\t\t// 不同于@click，这个@getuserinfo只能在用户授权的弹窗，当用户点击拒绝或接受才会触发这个事件，并且这个事件只能用在小程序\n\t\t\tbindGetUserInfo (e) {\n\t\t\t\t\tconsole.log('用户点击授权按钮')\n\t\t\t\t\tconsole.log(e)\n\t\t\t\t\tif (e.target.userInfo) {\n\t\t\t\t\t\tconsole.log('用户已授权-获取用户信息')\n\t\t\t\t\t\tconsole.log(e.target)\n\t\t\t\t\t\t// 拿到用户基本信息此时的操作，\n\t\t\t\t\t\t// 1将用户基本信息储存到本地 \n\t\t\t\t\t\tthis.setUserInfo()\n\t\t\t\t\t\t// 2 - 将 rawData 和 signature 发送给后台进行效验，然后拿到返回值：用户敏感信息\n\t\t\t\t\t\t// 使用util下自己封装的发送请求的函数 http_getUserInfo\n\t\t\t\t\t\t// 参数对象，格式是{rawData:xxx, signature: ''}\n\t\t\t\t\t\thttp_getUserInfo ({rawData: e.target.rawData, signature: e.target.signature})\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconsole.log('用户拒接登录，此时应显示弹窗告知用户“授权登录后才能使用xxx功能”')\n\t\t\t\t\t}\n\t\t\t},\n\t\t\t...mapMutations({\n\t\t\t        // 这里映射了这个方法，那么在调用x的时候，就等于使用了this.$store.commit('SET_SINGER', value)这个方法；\n\t\t\t        setUserInfo: 'setUserInfo',\n\t\t\t\t\t\t\tsetToken: 'setToken'\n\t\t\t})\n\t\t},\n\t\tcomputed: {\n\t\t\t// vuex提供的辅助函数，拿到store/getters.js向外暴露的内容；\n      ...mapGetters([\n        'store_UserInfo',\n\t\t\t\t'store_token'\n      ])\n    },\n\t}\n"],"sourceRoot":""}